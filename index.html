<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nucky24hs</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="logo.PNG">
    <meta name="theme-color" content="#0a0e1a">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <header>
            <h1 class="logo">Nucky<span>24hs</span></h1>
            <div class="header-icons">
                <a href="https://api.whatsapp.com/send?phone=5493517622725" target="_blank" rel="noopener noreferrer">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" width="30">
                </a>
            </div>
        </header>

        <section class="welcome-section">
            <h2 id="welcome-text">Bienvenido ğŸ‘‹</h2>
            <p class="user-id" id="user-id-text">Usuario: invitado</p>
        </section>

        <main class="grid-container">
            <button class="btn btn-green main-action" onclick="contactar('Cargar Saldo')">
                <span class="icon">ğŸ’°</span>
                Cargar Saldo
            </button>
            <button class="btn btn-blue main-action" onclick="contactar('Retirar Fondos')">
                <span class="icon">ğŸ†</span>
                Retirar Fondos
            </button>
            
            <button onclick="abrirJuego('https://celuapuestas.app')" class="btn btn-dark">
                <span class="icon">ğŸ°</span> Celuapuestas
            </button>
            <button onclick="abrirJuego('https://casinozeus.store')" class="btn btn-dark">
                <span class="icon">ğŸ²</span> Zeus
            </button>
            <button onclick="abrirJuego('https://www.bet30.sbs')" class="btn btn-dark">
                <span class="icon">ğŸƒ</span> Bet30
            </button>
            <button onclick="abrirJuego('https://bet32.online')" class="btn btn-dark">
                <span class="icon">ğŸ°</span> Bet32
            </button>
        </main>

        <button class="btn btn-support" onclick="contactar('AtenciÃ³n')">
            ğŸ’¬ AtenciÃ³n / Mensajes
        </button>
    </div>

    <script>
      // 1. GESTIÃ“N DE USUARIO
      const urlParams = new URLSearchParams(window.location.search);
      let nombreUsuario = urlParams.get('user');
      if (nombreUsuario) {
          localStorage.setItem('nucky_user', nombreUsuario);
      } else {
          nombreUsuario = localStorage.getItem('nucky_user') || "Usuario Nuevo";
      }

      document.getElementById('welcome-text').innerText = `Bienvenido, ${nombreUsuario} ğŸ‘‹`;
      document.getElementById('user-id-text').innerText = `Usuario: ${nombreUsuario}`;

      // 2. FUNCIÃ“N PARA FORZAR APERTURA EXTERNA EN IPHONE
      function abrirJuego(url) {
          // Creamos un elemento temporal de enlace
          const a = document.createElement('a');
          a.href = url;
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          // Esto es lo que a veces engaÃ±a al iPhone para que abra Safari
          a.click();
      }

      // 3. CONFIGURACIÃ“N DE CHATWOOT
      (function(d,t) {
        var BASE_URL="https://app.chatwoot.com";
        var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=BASE_URL+"/packs/js/sdk.js";
        g.async = true;
        s.parentNode.insertBefore(g,s);
        g.onload=function(){
          window.chatwootSDK.run({
            websiteToken: 'VKSvdtNfgr9Mj8VQcKjsH5fu',
            baseUrl: BASE_URL,
            locale: 'es'
          })
        }
      })(document,"script");

      window.addEventListener("chatwoot:ready", function () {
        window.$chatwoot.setUser(nombreUsuario, {
          name: nombreUsuario,
          identifier: nombreUsuario.toLowerCase().replace(/\s+/g, '_')
        });
      });

      function contactar(tipo) {
        if (window.$chatwoot) {
          window.$chatwoot.toggle("open");
          setTimeout(() => {
            let msg = (tipo === 'Cargar Saldo') ? `Hola! Soy ${nombreUsuario}, quiero CARGAR saldo.` : `Hola! Soy ${nombreUsuario}, deseo RETIRAR fondos.`;
            window.$chatwoot.sendMessage(msg);
          }, 800);
        } else {
            window.open(`https://api.whatsapp.com/send?phone=5493517622725&text=Hola! Soy ${nombreUsuario}, quiero ${tipo}`, '_blank');
        }
      }
    </script>
</body>
</html>
